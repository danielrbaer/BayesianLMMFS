Z,
p_k,
nsim=200,
burn=100,
thin=1,
Q=10^-3*I_J,
C_0=10^-3*I_q,
raw_MCMC_output = T
)
BayesianLMMFS::BayesianLMMFS()
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
uninstall('BayesianLMMFS')
setwd("..")
uninstall('BayesianLMMFS')
install("BayesianLMMFS")
library('BayesianLMMFS')
?BayesianLMMFS()
uninstall('BayesianLMMFS')
devtools::install_github('danielrbaer/BayesianLMMFS')
?BayesianLMMFS()
set.seed(123)
n<-100
p<-16
K<-4
J<-3
p_k<-rep(p/K,K)
q<-2
X<-matrix(rnorm(n*p),nrow=n,ncol=p)
Beta_k<-list()
for(k in 1:K){
Beta_k[[k]]<-matrix(rnorm(J*p_k[k]),nrow=p_k[k],ncol=J)
}
Beta_k[[1]]<-0*Beta_k[[1]]
Beta_k[[2]][1,]<-0*Beta_k[[2]][1,]
Beta<-dplyr::bind_rows(lapply(Beta_k,as.data.frame))%>%as.matrix
beta<-matrix(Beta,nrow=J*p,ncol=1)
Z<-list()
for(i in 1:n){
Z[[i]]<-matrix(0,nrow=J,ncol=q)
#For random intercept:
Z[[i]][,1]<-1
#For random slope:
Z[[i]][,2]<-sort(rexp(n=J,rate=1/20))
#Make first occasion 0:
Z[[i]][,2][1]<-0
}
sigma2<-1/20
sigma2_I_J<-sigma2*diag(J)
G<-matrix(c(1/2,-10^-3,
-10^-3,10^-4),
q,q,byrow = T)
Y_transpose<-matrix(0,nrow=J,ncol=n)
for (i in 1:n){
#This is X_i (J x Jp):
X_kron_i<-diag(J)%x%t(X[i,])
#Mean structure:
SS_MS_i<-X_kron_i%*%beta
#Covariance structure:
cov_y_i<-Z[[i]]%*%G%*%t(Z[[i]])+sigma2_I_J
#Outcome data:
Y_transpose[,i]<-MASS::mvrnorm(n=1,
mu=SS_MS_i,
Sigma=cov_y_i)
}
I_J<-diag(J)
I_q<-diag(q)
model_results<-
BayesianLMMFS::BayesianLMMFS(
Y_transpose,
X,
Z,
p_k,
nsim=200,
burn=100,
thin=1,
Q=10^-3*I_J,
C_0=10^-3*I_q,
raw_MCMC_output = T
)
uninstall('BayesianLMMFS')
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
#--------------------------------------------------------------------#
# Add function to R package which fits our model:
# All R functions in this R package belong in the R directory.
#--------------------------------------------------------------------#
#Generate function documentation .Rd file using roxygen syntax in model fit function:
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
#--------------------------------------------------------------------#
# Add function to R package which fits our model:
# All R functions in this R package belong in the R directory.
#--------------------------------------------------------------------#
#Generate function documentation .Rd file using roxygen syntax in model fit function:
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
uninstall('BayesianLMMFS')
setwd("..")
uninstall('BayesianLMMFS')
install("BayesianLMMFS")
library('BayesianLMMFS')
?BayesianLMMFS()
set.seed(123)
n<-100
p<-16
K<-4
J<-3
p_k<-rep(p/K,K)
q<-2
X<-matrix(rnorm(n*p),nrow=n,ncol=p)
Beta_k<-list()
for(k in 1:K){
Beta_k[[k]]<-matrix(rnorm(J*p_k[k]),nrow=p_k[k],ncol=J)
}
Beta_k[[1]]<-0*Beta_k[[1]]
Beta_k[[2]][1,]<-0*Beta_k[[2]][1,]
Beta<-dplyr::bind_rows(lapply(Beta_k,as.data.frame))%>%as.matrix
beta<-matrix(Beta,nrow=J*p,ncol=1)
Z<-list()
for(i in 1:n){
Z[[i]]<-matrix(0,nrow=J,ncol=q)
#For random intercept:
Z[[i]][,1]<-1
#For random slope:
Z[[i]][,2]<-sort(rexp(n=J,rate=1/20))
#Make first occasion 0:
Z[[i]][,2][1]<-0
}
sigma2<-1/20
sigma2_I_J<-sigma2*diag(J)
G<-matrix(c(1/2,-10^-3,
-10^-3,10^-4),
q,q,byrow = T)
Y_transpose<-matrix(0,nrow=J,ncol=n)
for (i in 1:n){
#This is X_i (J x Jp):
X_kron_i<-diag(J)%x%t(X[i,])
#Mean structure:
SS_MS_i<-X_kron_i%*%beta
#Covariance structure:
cov_y_i<-Z[[i]]%*%G%*%t(Z[[i]])+sigma2_I_J
#Outcome data:
Y_transpose[,i]<-MASS::mvrnorm(n=1,
mu=SS_MS_i,
Sigma=cov_y_i)
}
I_J<-diag(J)
I_q<-diag(q)
model_results<-
BayesianLMMFS::BayesianLMMFS(
Y_transpose,
X,
Z,
p_k,
nsim=200,
burn=100,
thin=1,
Q=10^-3*I_J,
C_0=10^-3*I_q,
raw_MCMC_output = T
)
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
#--------------------------------------------------------------------#
# Add function to R package which fits our model:
# All R functions in this R package belong in the R directory.
#--------------------------------------------------------------------#
#Generate function documentation .Rd file using roxygen syntax in model fit function:
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
setwd("..")
uninstall('BayesianLMMFS')
install("BayesianLMMFS")
library('BayesianLMMFS')
?BayesianLMMFS()
set.seed(123)
n<-100
p<-16
K<-4
J<-3
p_k<-rep(p/K,K)
q<-2
X<-matrix(rnorm(n*p),nrow=n,ncol=p)
Beta_k<-list()
for(k in 1:K){
Beta_k[[k]]<-matrix(rnorm(J*p_k[k]),nrow=p_k[k],ncol=J)
}
Beta_k[[1]]<-0*Beta_k[[1]]
Beta_k[[2]][1,]<-0*Beta_k[[2]][1,]
Beta<-dplyr::bind_rows(lapply(Beta_k,as.data.frame))%>%as.matrix
beta<-matrix(Beta,nrow=J*p,ncol=1)
Z<-list()
for(i in 1:n){
Z[[i]]<-matrix(0,nrow=J,ncol=q)
#For random intercept:
Z[[i]][,1]<-1
#For random slope:
Z[[i]][,2]<-sort(rexp(n=J,rate=1/20))
#Make first occasion 0:
Z[[i]][,2][1]<-0
}
sigma2<-1/20
sigma2_I_J<-sigma2*diag(J)
G<-matrix(c(1/2,-10^-3,
-10^-3,10^-4),
q,q,byrow = T)
Y_transpose<-matrix(0,nrow=J,ncol=n)
for (i in 1:n){
#This is X_i (J x Jp):
X_kron_i<-diag(J)%x%t(X[i,])
#Mean structure:
SS_MS_i<-X_kron_i%*%beta
#Covariance structure:
cov_y_i<-Z[[i]]%*%G%*%t(Z[[i]])+sigma2_I_J
#Outcome data:
Y_transpose[,i]<-MASS::mvrnorm(n=1,
mu=SS_MS_i,
Sigma=cov_y_i)
}
I_J<-diag(J)
I_q<-diag(q)
model_results<-
BayesianLMMFS::BayesianLMMFS(
Y_transpose,
X,
Z,
p_k,
nsim=200,
burn=100,
thin=1,
Q=10^-3*I_J,
C_0=10^-3*I_q,
raw_MCMC_output = T
)
devtools::install_github('danielrbaer/BayesianLMMFS')
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
setwd("..")
uninstall('BayesianLMMFS')
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
setwd("..")
install("BayesianLMMFS")
library('BayesianLMMFS')
?BayesianLMMFS()
set.seed(123)
n<-100
n<-100
p<-16
K<-4
J<-3
p_k<-rep(p/K,K)
q<-2
X<-matrix(rnorm(n*p),nrow=n,ncol=p)
Beta_k<-list()
for(k in 1:K){
Beta_k[[k]]<-matrix(rnorm(J*p_k[k]),nrow=p_k[k],ncol=J)
}
Beta_k[[1]]<-0*Beta_k[[1]]
Beta_k[[2]][1,]<-0*Beta_k[[2]][1,]
Beta<-dplyr::bind_rows(lapply(Beta_k,as.data.frame))%>%as.matrix
beta<-matrix(Beta,nrow=J*p,ncol=1)
Z<-list()
for(i in 1:n){
Z[[i]]<-matrix(0,nrow=J,ncol=q)
#For random intercept:
Z[[i]][,1]<-1
#For random slope:
Z[[i]][,2]<-sort(rexp(n=J,rate=1/20))
#Make first occasion 0:
Z[[i]][,2][1]<-0
}
sigma2<-1/20
sigma2_I_J<-sigma2*diag(J)
G<-matrix(c(1/2,-10^-3,
-10^-3,10^-4),
q,q,byrow = T)
Y_transpose<-matrix(0,nrow=J,ncol=n)
I_J<-diag(J)
I_q<-diag(q)
model_results<-
BayesianLMMFS::BayesianLMMFS(
Y_transpose,
X,
Z,
p_k,
nsim=200,
burn=100,
thin=1,
Q=10^-3*I_J,
C_0=10^-3*I_q,
raw_MCMC_output = T
)
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
#--------------------------------------------------------------------#
# Add function to R package which fits our model:
# All R functions in this R package belong in the R directory.
uninstall('BayesianLMMFS')
setwd("..")
uninstall('BayesianLMMFS')
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
setwd("..")
install("BayesianLMMFS")
library('BayesianLMMFS')
library('BayesianLMMFS')
library('BayesianLMMFS')
library('BayesianLMMFS')
?BayesianLMMFS()
set.seed(123)
n<-100
p<-16
K<-4
J<-3
p_k<-rep(p/K,K)
q<-2
X<-matrix(rnorm(n*p),nrow=n,ncol=p)
Beta_k<-list()
for(k in 1:K){
Beta_k[[k]]<-matrix(rnorm(J*p_k[k]),nrow=p_k[k],ncol=J)
}
Beta_k[[1]]<-0*Beta_k[[1]]
Beta_k[[2]][1,]<-0*Beta_k[[2]][1,]
Beta<-dplyr::bind_rows(lapply(Beta_k,as.data.frame))%>%as.matrix
beta<-matrix(Beta,nrow=J*p,ncol=1)
Z<-list()
for(i in 1:n){
Z[[i]]<-matrix(0,nrow=J,ncol=q)
#For random intercept:
Z[[i]][,1]<-1
#For random slope:
Z[[i]][,2]<-sort(rexp(n=J,rate=1/20))
#Make first occasion 0:
Z[[i]][,2][1]<-0
}
sigma2<-1/20
sigma2_I_J<-sigma2*diag(J)
G<-matrix(c(1/2,-10^-3,
-10^-3,10^-4),
q,q,byrow = T)
Y_transpose<-matrix(0,nrow=J,ncol=n)
for (i in 1:n){
#This is X_i (J x Jp):
X_kron_i<-diag(J)%x%t(X[i,])
#Mean structure:
SS_MS_i<-X_kron_i%*%beta
#Covariance structure:
cov_y_i<-Z[[i]]%*%G%*%t(Z[[i]])+sigma2_I_J
#Outcome data:
Y_transpose[,i]<-MASS::mvrnorm(n=1,
mu=SS_MS_i,
Sigma=cov_y_i)
}
I_J<-diag(J)
I_q<-diag(q)
model_results<-
BayesianLMMFS::BayesianLMMFS(
Y_transpose,
X,
Z,
p_k,
nsim=200,
burn=100,
thin=1,
Q=10^-3*I_J,
C_0=10^-3*I_q,
raw_MCMC_output = T
)
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
#--------------------------------------------------------------------#
# Add function to R package which fits our model:
# All R functions in this R package belong in the R directory.
#--------------------------------------------------------------------#
#Generate function documentation .Rd file using roxygen syntax in model fit function:
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
uninstall('BayesianLMMFS')
setwd("..")
uninstall('BayesianLMMFS')
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
setwd("..")
devtools::document()
#Packages:
library("devtools")
library('roxygen2')
library("mathjaxr")
library('dplyr')
library('ggplot2')
library("knitr")
library('Rdpack')
#--------------------------------------------------------------------#
# Add function to R package which fits our model:
# All R functions in this R package belong in the R directory.
#--------------------------------------------------------------------#
#Generate function documentation .Rd file using roxygen syntax in model fit function:
setwd('C:/Users/baerd/Desktop/BayesianLMMFS')
devtools::document()
setwd("..")
install("BayesianLMMFS")
library('BayesianLMMFS')
?BayesianLMMFS()
set.seed(123)
n<-100
p<-16
K<-4
J<-3
p_k<-rep(p/K,K)
q<-2
X<-matrix(rnorm(n*p),nrow=n,ncol=p)
Beta_k<-list()
for(k in 1:K){
Beta_k[[k]]<-matrix(rnorm(J*p_k[k]),nrow=p_k[k],ncol=J)
}
Beta_k[[1]]<-0*Beta_k[[1]]
Beta_k[[2]][1,]<-0*Beta_k[[2]][1,]
Beta<-dplyr::bind_rows(lapply(Beta_k,as.data.frame))%>%as.matrix
beta<-matrix(Beta,nrow=J*p,ncol=1)
Z<-list()
for(i in 1:n){
Z[[i]]<-matrix(0,nrow=J,ncol=q)
#For random intercept:
Z[[i]][,1]<-1
#For random slope:
Z[[i]][,2]<-sort(rexp(n=J,rate=1/20))
#Make first occasion 0:
Z[[i]][,2][1]<-0
}
sigma2<-1/20
sigma2_I_J<-sigma2*diag(J)
G<-matrix(c(1/2,-10^-3,
-10^-3,10^-4),
q,q,byrow = T)
Y_transpose<-matrix(0,nrow=J,ncol=n)
for (i in 1:n){
#This is X_i (J x Jp):
X_kron_i<-diag(J)%x%t(X[i,])
#Mean structure:
SS_MS_i<-X_kron_i%*%beta
#Covariance structure:
cov_y_i<-Z[[i]]%*%G%*%t(Z[[i]])+sigma2_I_J
#Outcome data:
Y_transpose[,i]<-MASS::mvrnorm(n=1,
mu=SS_MS_i,
Sigma=cov_y_i)
}
I_J<-diag(J)
I_q<-diag(q)
model_results<-
BayesianLMMFS::BayesianLMMFS(
Y_transpose,
X,
Z,
p_k,
nsim=200,
burn=100,
thin=1,
Q=10^-3*I_J,
C_0=10^-3*I_q,
raw_MCMC_output = T
)
